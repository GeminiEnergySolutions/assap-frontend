"use strict";(self.webpackChunkconserve=self.webpackChunkconserve||[]).push([[319],{319:(M,p,i)=>{i.r(p),i.d(p,{SettingsModule:()=>A});var u=i(4542),c=i(1904),m=i(4543),g=i(3275),e=i(7156),d=i(6680),v=i(6923),h=i(9361),C=i(1177),Z=i(4979);function _(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"h4"),e._uU(1," Logged in as "),e.TgZ(2,"b"),e._uU(3),e.qZA(),e._uU(4,". "),e.TgZ(5,"button",16),e.NdJ("click",function(){return e.CHM(t),e.oxw().logout()}),e._uU(6," Log out "),e.qZA(),e.qZA()}if(2&n){const t=e.oxw();e.xp6(3),e.Oqu(t.user.username)}}function y(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"div",13),e.TgZ(1,"div",2),e.TgZ(2,"label",17),e._uU(3,"Username"),e.qZA(),e.TgZ(4,"input",18),e.NdJ("ngModelChange",function(s){return e.CHM(t),e.oxw().username=s}),e.qZA(),e.qZA(),e.TgZ(5,"div",2),e.TgZ(6,"label",19),e._uU(7,"Password"),e.qZA(),e.TgZ(8,"input",20),e.NdJ("ngModelChange",function(s){return e.CHM(t),e.oxw().password=s}),e.qZA(),e.qZA(),e.TgZ(9,"button",21),e.NdJ("click",function(){return e.CHM(t),e.oxw().login()}),e._uU(10," Log in "),e.qZA(),e.qZA()}if(2&n){const t=e.oxw();e.xp6(4),e.Q6J("ngModel",t.username),e.xp6(4),e.Q6J("ngModel",t.password)}}const S={403:"Invalid credentials",404:"Invalid server URL.",0:"Can't connect to server."},f=[{path:"",component:(()=>{class n{constructor(t,o,s,r,l){this.parseCredentialService=t,this.companycamCredentialService=o,this.parseService=s,this.toastService=r,this.companycamService=l}ngOnInit(){this.url=this.parseCredentialService.url,this.appId=this.parseCredentialService.appId,this.masterKey=this.parseCredentialService.masterKey,this.companycamApiKey=this.companycamCredentialService.apiKey,this.parseCredentialService.sessionToken&&this.parseService.getCurrentUser().subscribe(t=>this.user=t)}save(){this.parseCredentialService.url=this.url,this.parseCredentialService.appId=this.appId,this.parseCredentialService.masterKey=this.masterKey}test(){this.save(),(this.username&&this.password?this.parseService.login(this.username,this.password):this.parseService.getConfig()).subscribe(()=>{this.toastService.success("Parse Server","Successfully connected to Parse server.")},o=>{var s,r;console.error(o);const l=null!==(r=null===(s=o.error)||void 0===s?void 0:s.error)&&void 0!==r?r:S[o.status];this.toastService.error("Parse Server",`Failed to connect to Parse server: ${l}`,o)})}logout(){this.parseService.logout().subscribe(()=>{delete this.user},t=>{this.toastService.error("Log out","Failed to log out",t)})}login(){!this.username||!this.password||this.parseService.login(this.username,this.password).subscribe(t=>{this.user=t},t=>{this.toastService.error("Log in","Failed to log in",t)})}saveCompanycam(){this.companycamCredentialService.apiKey=this.companycamApiKey}testCompanycam(){this.saveCompanycam(),this.companycamService.test(this.companycamApiKey).subscribe(t=>{this.toastService.success("Companycam",`Logged in as ${t.first_name} ${t.last_name}`)},t=>{this.toastService.error("Companycam","Failed to log in",t)})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(d.U),e.Y36(v.L),e.Y36(h.X),e.Y36(C.kl),e.Y36(Z.Y))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-settings"]],decls:37,vars:6,consts:[[1,"container"],[1,"form","mb-3"],[1,"form-group"],["for","url"],["type","url","id","url",1,"form-control",3,"ngModel","ngModelChange"],["for","appId"],["type","text","id","appId",1,"form-control",3,"ngModel","ngModelChange"],["for","masterKey"],["type","password","id","masterKey","autocomplete","new-password",1,"form-control",3,"ngModel","ngModelChange"],["type","button",1,"btn","btn-primary","mr-2",3,"click"],["type","button",1,"btn","btn-success",3,"click"],[4,"ngIf"],["class","form",4,"ngIf"],[1,"form"],["for","companyCamApiKeyInput"],["type","password","id","companyCamApiKeyInput","autocomplete","off",1,"form-control",3,"ngModel","ngModelChange"],["type","button",1,"btn","btn-danger",3,"click"],["for","username"],["type","text","id","username","autocomplete","username",1,"form-control",3,"ngModel","ngModelChange"],["for","password"],["type","password","id","password","autocomplete","password",1,"form-control",3,"ngModel","ngModelChange"],["type","button",1,"btn","btn-primary",3,"click"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"h1"),e._uU(2,"Settings"),e.qZA(),e.TgZ(3,"h2"),e._uU(4,"Parse Server"),e.qZA(),e.TgZ(5,"div",1),e.TgZ(6,"div",2),e.TgZ(7,"label",3),e._uU(8,"Parse Server URL"),e.qZA(),e.TgZ(9,"input",4),e.NdJ("ngModelChange",function(r){return o.url=r}),e.qZA(),e.qZA(),e.TgZ(10,"div",2),e.TgZ(11,"label",5),e._uU(12,"Parse App ID"),e.qZA(),e.TgZ(13,"input",6),e.NdJ("ngModelChange",function(r){return o.appId=r}),e.qZA(),e.qZA(),e.TgZ(14,"div",2),e.TgZ(15,"label",7),e._uU(16,"Parse Master Key (Optional)"),e.qZA(),e.TgZ(17,"input",8),e.NdJ("ngModelChange",function(r){return o.masterKey=r}),e.qZA(),e.qZA(),e.TgZ(18,"button",9),e.NdJ("click",function(){return o.save()}),e._uU(19," Save "),e.qZA(),e.TgZ(20,"button",10),e.NdJ("click",function(){return o.test()}),e._uU(21," Test "),e.qZA(),e.qZA(),e.TgZ(22,"h2"),e._uU(23,"User"),e.qZA(),e.YNc(24,_,7,1,"h4",11),e.YNc(25,y,11,2,"div",12),e.TgZ(26,"h2"),e._uU(27,"CompanyCam"),e.qZA(),e.TgZ(28,"div",13),e.TgZ(29,"div",2),e.TgZ(30,"label",14),e._uU(31,"API Key"),e.qZA(),e.TgZ(32,"input",15),e.NdJ("ngModelChange",function(r){return o.companycamApiKey=r}),e.qZA(),e.qZA(),e.TgZ(33,"button",9),e.NdJ("click",function(){return o.saveCompanycam()}),e._uU(34," Save "),e.qZA(),e.TgZ(35,"button",10),e.NdJ("click",function(){return o.testCompanycam()}),e._uU(36," Test "),e.qZA(),e.qZA(),e.qZA()),2&t&&(e.xp6(9),e.Q6J("ngModel",o.url),e.xp6(4),e.Q6J("ngModel",o.appId),e.xp6(4),e.Q6J("ngModel",o.masterKey),e.xp6(7),e.Q6J("ngIf",o.user),e.xp6(1),e.Q6J("ngIf",!o.user),e.xp6(7),e.Q6J("ngModel",o.companycamApiKey))},directives:[c.Fj,c.JJ,c.On,u.O5],styles:[""]}),n})()}];let T=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[[g.Bz.forChild(f)],g.Bz]}),n})(),A=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[[u.ez,c.u5,T,m.B]]}),n})()}}]);